<!DOCTYPE html>
<html>
<head>
<meta charset="ISO-8859-1">
<title>Project 1 Employee Reimbursement System</title>
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.0/css/bootstrap.min.css">
<link rel="shortcut icon" href="img/favicon.ico" type="image/icon"> 
<link rel="icon" href="img/favicon.ico" type="image/icon"> 
<style>
form { accept-charset : utf-8; }
</style>
</head>
<body>

<div class="bodyHeading">
	<div class="jumbotron text-center">
		<h3>Your Reimbursement History</h3>
	</div>
</div>

<div style="text-align:center" class="bodyList">
		<!--
		<form accept-charset=utf-8 method="POST" action="http://localhost:8080/Project1Reimbursement/html/EmpHistTable.do">
			<input type="submit" value="See Active First" class="form-control btn btn-info"/>
			<table id="EmpHistoryViewerTable" style="width:100%"></table>
		</form>
		/-->
		<!-- Time Stamp Submitted/Resolved, typeOfTicket, Description, status, pictures /-->
	 	<table style="width:100%">
			<tr>
				<th>$ Amount</th>
				<th>Status</th>
				<th>Type</th>
				<th>Description</th>
				<th>Addendum</th>
				<th>Time Submitted</th>
				<th>Time Resolved</th>
			</tr>
		</table>
</div>
<div style="text-align:center" class="container">
	<form accept-charset=utf-8 action="http://localhost:8080/Project1Reimbursement/html/EmployeeMainMenu.html" method="get">
		<input type="submit" value="Back" class="form-control btn btn-info"/>
	</form>
</div>
<!--  /-->
<script type="text/javascript">
window.onload = function(){
	getReimbursementInfo();
}

function getReimbursementInfo(){
	let xhttp = new XMLHttpRequest();
	xhttp.onreadystatechange = function(){
		if(xhttp.readyState == 4 && xhttp.status == 200){
			let reimbursements = JSON.parse(xhttp.responseText);
			setValues(reimbursements);
		}
	}
	xhttp.open("GET", 'http://localhost:8080/Project1Reimbursement/html/EmpHistTable.do', true);
	xhttp.send();
}
function setValues(reimbursement){
	document.getElementById("EmpHistoryViewerTable").innerHTML = makeEmployeeHistoryTable(document.getElementById("EmpHistoryViewerTable"), reimbursements);
}
function makeEmployeeHistoryTable(table, reimbursements){
	for(i=0; i < reimbursements.results.length; i++){
		row = getRowEmployeeHistoryTable(table, reimbursements[i]);
		table.Rows.Add(row);
	}
	return table.innerHTML;
}
function getRowEmployeeHistoryTable(table, reimbursement){
	var row = new HtmlTableRow();
	var cell0 = new HtmlTableCell(); cell0 = row.insertCell(0);
	var cell1 = new HtmlTableCell(); cell1 = row.insertCell(1);
	var cell2 = new HtmlTableCell(); cell2 = row.insertCell(2);
	var cell3 = new HtmlTableCell(); cell3 = row.insertCell(3);
	var cell4 = new HtmlTableCell(); cell4 = row.insertCell(4);
	var cell5 = new HtmlTableCell(); cell5 = row.insertCell(5);
	var cell6 = new HtmlTableCell(); cell6 = row.insertCell(6);
	cell0.innerHTML = reimbursement.amount; // $ Amount
	cell1.innerHTML = reimbursement.statusId; // Status
	cell2.innerHTML = reimbursement.typeId; // Type
	cell3.innerHTML = reimbursement.description; // Description
	cell4.innerHTML = reimbursement.receipt; // Addendum"
	cell5.innerHTML = reimbursement.dateSubmitted; // Time Submitted
	cell6.innerHTML = reimbursement.dateResolved; // Time Resolved
	row.Cells.Add(cell0);
	row.Cells.Add(cell1);
	row.Cells.Add(cell2);
	row.Cells.Add(cell3);
	row.Cells.Add(cell4);
	row.Cells.Add(cell5);
	row.Cells.Add(cell6);
	
	return row;
}
</script>
<script src="https://code.jquery.com/jquery-3.4.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.0/js/bootstrap.min.js"></script>

</body>
</html>